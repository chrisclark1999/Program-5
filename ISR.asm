; ISR.asm
; Name:
; UTEid: 
; Keyboard ISR runs when a key is struck
; Checks for a valid RNA symbol and places it at x4600
               .ORIG x2600
LOOP1
LDI R0 KBSR
BRz LOOP1
LDI R1 KBDR

;CHECK A
LD R0 A
ADD R0 R0 R1
BRnp CHECKC
LOOPA
LDI R0 DSR
BRz LOOPA
LD R1 A
NOT R1 R1
ADD R1 R1 #1
STI R1 OUTPUT
RTI

CHECKC
LD R0 C
ADD R0 R0 R1
BRnp CHECKG
LOOPC
LDI R0 DSR
BRz LOOPC
LD R1 C
NOT R1 R1
ADD R1 R1 #1
STI R1 OUTPUT
RTI

CHECKG
LD R0 G
ADD R0 R0 R1
BRnp CHECKU
LOOPG
LDI R0 DSR
BRz LOOPG
LD R1 G
NOT R1 R1
ADD R1 R1 #1
STI R1 OUTPUT
RTI

CHECKU
LD R0 U
ADD R0 R0 R1
BRnp NOTVALID
LOOPU
LDI R0 DSR
BRz LOOPU
LD R1 U
NOT R1 R1
ADD R1 R1 #1
STI R1 OUTPUT
RTI

NOTVALID
RTI



A .FILL -65
C .FILL -67
G .FILL -71
U .FILL -85
KBDR .FILL xFE02
KBSR .FILL xFE00
DSR .FILL xFE04
DDR .FILL xFE06
OUTPUT .FILL x4600
		.END
